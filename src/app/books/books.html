<div class="container books-content">
    <div class="filter-bar">
        <mat-form-field appearance="outline" class="category-filter">
            <mat-label>{{ 'books.filter.categories' | translate }}</mat-label>
            <mat-select multiple
                [(value)]="selectedCategories"
                (selectionChange)="onCategorySelectionChange($event.value)">

                <mat-option value="All">{{ 'books.filter.all' | translate }}</mat-option>

                @for (category of allCategories(); track category) {
                <mat-option [value]="category">
                    {{ category }}
                </mat-option>
                }
            </mat-select>
        </mat-form-field>
        <span class="book-count">
            {{ 'books.filter.found' | translate: {count: filteredCount()} }}
        </span>
    </div>
    
  <div class="book-list">
    @for (book of filteredBooks(); track book.id) {
        <div class="book-row">
            <mat-card appearance="outlined" >
                <mat-card-header>
                    <mat-card-title>{{ book.title }}</mat-card-title>
                    <mat-card-subtitle>{{ book.subtitle }}</mat-card-subtitle>
                </mat-card-header>
                <mat-card-content class="card-content">
                    <img class="book-image" src="book.jpg" alt="Book image" />
                    <div class="card-body">
                        <p><strong>{{ 'books.card.category' | translate }}:</strong> {{ book.categories.join(', ') }}</p>
                        <p><strong>{{ 'books.card.price' | translate }}:</strong> {{ book.price | currency: 'EUR' }}</p>
                        <div class="details-button">
                            <button mat-raised-button color="primary" [routerLink]="['/books', book.id]">
                                {{ 'books.card.show' | translate }}
                            </button>
                        </div>
                    </div>
                     <div class="buy-button">
                        <button mat-raised-button 
                            color="accent" 
                            class="buy-button-inner" 
                            [routerLink]="['/checkout']"
                            (click)="onBuy(book)">
                            {{ 'books.card.buy' | translate }}
                        </button>
                    </div>
                </mat-card-content>
            </mat-card>
        </div>
    }
  </div>
</div>
